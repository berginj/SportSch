---
import BaseLayout from "../layouts/BaseLayout.astro";
import site from "../config/site.json";
import registrationLinks from "../config/registration-links.json";
import LastUpdated from "../components/LastUpdated.astro";

const sorted = [...registrationLinks].sort((a, b) => a.priority - b.priority);
---

<BaseLayout title="Registration" path="/register">
  <section class="container-shell py-12">
    <h1 class="font-display text-5xl text-brand-secondary">Registration</h1>
    <p class="mt-4 max-w-3xl text-slate-600">
      This is the single registration doorway for AGSA. Choose your season and program below.
    </p>
    <LastUpdated date={site.lastUpdated} />
  </section>

  <section class="container-shell pb-12">
    <div class="grid gap-5 md:grid-cols-2">
      {
        sorted.map((link) => (
          <article class="card p-6" data-highlight-until={link.highlightUntil || ""}>
            <p class="m-0 text-xs font-bold uppercase tracking-wide text-brand-primary">{link.season}</p>
            <p class="mt-1 text-xs uppercase tracking-wide text-slate-500">{link.program}</p>
            {
              link.highlightLabel && (
                <p
                  data-highlight-badge
                  hidden
                  class="mt-2 inline-flex rounded-full bg-brand-accent px-2.5 py-1 text-[11px] font-bold uppercase tracking-wide text-brand-secondary"
                >
                  {link.highlightLabel}
                </p>
              )
            }
            <h2 class="mt-2 text-2xl font-semibold text-brand-secondary">{link.label}</h2>
            <p class="mt-3 text-sm text-slate-600">{link.description}</p>
            {
              link.status === "open" ? (
                <a class="btn-primary mt-5" href={link.url} target="_blank" rel="noreferrer">
                  Open registration
                </a>
              ) : (
                <span class="mt-5 inline-flex rounded-full bg-slate-100 px-3 py-1.5 text-xs font-semibold uppercase tracking-wide text-slate-600">
                  Closed
                </span>
              )
            }
          </article>
        ))
      }
    </div>
  </section>

  <script>
    import "../scripts/registration-highlight.js";
  </script>
</BaseLayout>
